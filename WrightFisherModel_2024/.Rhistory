Mass_ggC_all_gene_freqs_dict["ERS043857_00117"]
match_MassMassCOGsUnfiltered_99["match_MassMassCOGsUnfiltered_99"]
match_MassMassCOGsUnfiltered_99["ERS043857_00117"]
Mass_ggC_all_gene_freqs_dict["CLS03197"]
Mass_cog_all_gene_freqs_dict["CLS03197"]
Mass_ggC_all_gene_freqs_dict["ERS044105_00813~~~ERS043890_00794~~~ERS070117_00685"]
match_MassMassCOGsUnfiltered_99["ERS044105_00813~~~ERS043890_00794~~~ERS070117_00685"]
Mass_cog_all_gene_freqs_dict["CLS00429"]
View(gene_presence_absence_2001)
which(cog_all_gene_names == "CLS03197")
sum(gene_presence_absence_2001[(which(cog_all_gene_names == "CLS03197"))+1,])
sum(gene_presence_absence_2001[1874,])
sum(gene_presence_absence_2001[1874,-1])
gene_presence_absence_2001[1874,-1]
sum(as.integerg(gene_presence_absence_2001[1874,-1]))
sum(as.integer(gene_presence_absence_2001[1874,-1]))
sum(as.integer(gene_presence_absence_2001[1874,-1]))/length(gene_presence_absence_2001[1874,-1])
Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)]
sort(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)])
as.vector(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)])
as.vector(Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])
Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)][153]
Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]][153]
View(ggCaller_gene_presence_absence_2001)
View(ggCaller_gene_presence_absence)
ggCaller_bool_gene_presence_absence <- readRDS("ggCaller_presence_absence_matrix.rds")
View(ggCaller_bool_gene_presence_absence)
# reading in the gene presence absence matrix produced by ggCaller
#ggCaller_gene_presence_absence <- read.csv(paste(path_to_data, "Massachusetts_ggcaller/run2/ggCaller_output/gene_presence_absence.csv", sep = ""), header=FALSE)
ggCaller_gene_presence_absence <- read.csv(paste(path_to_data, "Massachusetts_ggcaller/run_withFuncAnn/ggCaller_output/gene_presence_absence.csv", sep = ""), header=FALSE)
View(ggCaller_gene_presence_absence)
Mass_ggC_all_gene_freqs_dict["group_367"]
match_MassMassCOGsUnfiltered_99["group_367"]
match_MassMassCOGsUnfiltered_90["group_367"]
match_MassCOGsMassUnfiltered_90["group_367"]
head(match_MassMassCOGsUnfiltered_90)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_90)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_90[names(match_MassMassCOGsUnfiltered_90)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_95)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_95[names(match_MassMassCOGsUnfiltered_95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
abline(0,1)
View(gene_presence_absence)
seq_no_per_year <- rep(0, length(Nepal_time_points))
names(seq_no_per_year) <- Nepal_time_points
for (i in 1:length(Nepal_time_points)) {
seq_no_per_year[i] <- length(which(Nepal_meta_data_gps_joined$Year==Nepal_time_points[i]))
}
barplot(seq_no_per_year, xlab = "Sequencing Years", ylim = c(0, 1200), ylab = "Sequence Counts")
seq_no_per_year
Navajo_time_seq <- Navajo_time_points[1]:Navajo_time_points[length(Navajo_time_points)]
seq_no_per_year <- rep(0, length(Navajo_time_seq))
names(seq_no_per_year) <- Navajo_time_seq
for (i in 1:length(Navajo_time_seq)) {
seq_no_per_year[i] <- length(which(Navajo_meta_data$Year==Navajo_time_seq[i]))
}
barplot(seq_no_per_year, xlab = "Sequencing Years", ylab = "Sequence Counts", col = rainbow(15))
length(unique(Nepal_Serotype_dict))
unique(Nepal_Serotype_dict)
length(unique(Nepal_meta_dataPP$Serotype))
View(Navajo_meta_data)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
MassCOGs_seqlengths <- read.delim("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Mass_COGs/sequence_lengths.csv", header=FALSE)
head(MassCOGs_seqlengths)
MassCOGs_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Mass_COGs/sequence_lengths.csv", header=FALSE)
head(MassCOGs_seqlengths)
MassCOGs_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Mass_COGs/sequence_lengths.csv", header=TRUE)
head(MassCOGs_seqlengths)
MassCOGs_seqlengths_dict <- MassCOGs_seqlengths$Length
names(MassCOGs_seqlengths_dict) <- MassCOGs_seqlengths$GeneCluster
head(names(match_MassMassCOGsUnfiltered_99))
plot(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
MassggC_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Massachusets/sequence_lengths_AllMass.csv", header=TRUE)
MassggC_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Massachusetts/sequence_lengths_AllMass.csv", header=TRUE)
MassggC_seqlengths_dict <- MassggC_seqlengths$Length
names(MassggC_seqlengths_dict) <- MassggC_seqlengths$GeneCluster
head(MassggC_seqlengths_dict)
plot(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length", ylab = "Mass COG gene length",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length", ylab = "Mass COG gene length",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length", ylab = "Mass COG gene length",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length - Mass COG gene length", ylab = "Mass ggCaller gene freq - Mass COG gene freq",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "red")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "red", pch = 19)
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "#E69F0070", pch = 19)
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], col = "#56B4E970")
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "#E69F0070")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], col = "#56B4E980", pch = 19)
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "#E69F0080", pch = 19)
plot(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]), col = "#56B4E980", pch = 19)
points(sort(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]]), col = "#E69F0080", pch = 19)
head(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]))
names(head(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])))
plot(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]), col = "#56B4E980", pch = 19)
points(sort(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(head(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])))]), col = "#E69F0080", pch = 19)
points(sort(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(head(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]))]), col = "#E69F0080", pch = 19)
plot(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]), col = "#56B4E980", pch = 19)
points((MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]))]), col = "#E69F0080", pch = 19)
plot(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]), col = "#56B4E980", pch = 19)
points((MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]))]]), col = "#E69F0080", pch = 19)
plot(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
head(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.1)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
points(Mass_ggC_all_gene_freqs_dict[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.1))], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.1))]], col = "red")
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
points(Mass_ggC_all_gene_freqs_dict[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.2))], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.2))]], col = "red")
MassCOGs_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Mass_COGs/sequence_lengths.csv", header=TRUE)
MassCOGs_seqlengths_dict <- MassCOGs_seqlengths$Length
names(MassCOGs_seqlengths_dict) <- MassCOGs_seqlengths$GeneCluster
plot(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
MassggC_seqlengths <- read.csv("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/Massachusetts/sequence_lengths_AllMass.csv", header=TRUE)
MassggC_seqlengths_dict <- MassggC_seqlengths$Length
names(MassggC_seqlengths_dict) <- MassggC_seqlengths$GeneCluster
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length", ylab = "Mass COG gene length",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length - Mass COG gene length", ylab = "Mass ggCaller gene freq - Mass COG gene freq",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], col = "#56B4E980", pch = 19)
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "#E69F0080", pch = 19)
length(match_MassMassCOGsUnfiltered_95)
length(match_MassCOGsMassUnfiltered_95)
head(match_MassMassCOGsUnfiltered_95)
head(colours_MassUnfiltered_95)
# colur by genes that are under NFDS in Mass ggCaller
colours_MassUnfiltered_95 <- rep("grey", length(match_MassMassCOGsUnfiltered_95))
names(colours_MassUnfiltered_95) <- names(match_MassMassCOGsUnfiltered_95)
head(colours_MassUnfiltered_95)
colours_MassUnfiltered_95[names(which(Mass_underNFDS[names(match_MassMassCOGsUnfiltered_95)]==1))] <- col_clb[3]
head(colours_MassUnfiltered_95)
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_95)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_95[names(match_MassMassCOGsUnfiltered_95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity", col = colours_MassUnfiltered_95, pch = 19)
abline(0,1)
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length", ylab = "Mass COG gene length",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)] - Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene length - Mass COG gene length", ylab = "Mass ggCaller gene freq - Mass COG gene freq",main="All Gene Frequencies, 99% sequence identity")
plot(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)], col = "#56B4E980", pch = 19)
points(MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], col = "#E69F0080", pch = 19)
plot(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]), col = "#56B4E980", pch = 19)
points((MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(sort(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)]))]]), col = "#E69F0080", pch = 19)
plot(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)])
# maybe filter matches by length difference?
plot(Mass_ggC_all_gene_freqs_dict[names(match_MassMassCOGsUnfiltered_99)], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 99% sequence identity")
points(Mass_ggC_all_gene_freqs_dict[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.2))], Mass_cog_all_gene_freqs_dict[match_MassMassCOGsUnfiltered_99[names(which(abs(MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] - MassCOGs_seqlengths_dict[match_MassMassCOGsUnfiltered_99[names(match_MassMassCOGsUnfiltered_99)]])/MassggC_seqlengths_dict[names(match_MassMassCOGsUnfiltered_99)] > 0.2))]], col = "red")
# 15.01.2025
# using reciprocal match function of mmseqs
mmseq_results_RecipMassggCMassCOGs_unfiltered <- read.delim("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/MMseqs2_results/RecipBestHit_ggCMassCOGMass/MassCOGggC_recipBestHit", header=FALSE)
head(mmseq_results_RecipMassggCMassCOGs_unfiltered)
# 15.01.2025
# using reciprocal match function of mmseqs
mmseq_results_RecipMassggCMassCOGs_unfiltered <- read.delim("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/MMseqs2_results/RecipBestHit_ggCMassCOGMass/MassCOGggC_recipBestHit", header=TRUE)
head(mmseq_results_RecipMassggCMassCOGs_unfiltered)
nrow(mmseq_results_RecipMassggCMassCOGs_unfiltered)
nrow(mmseq_results_FindMassInMassCOGs_unfiltered)
nrow(mmseq_results_FindMassCOGsInMass_unfiltered)
unique(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident)
length(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9))
length(match_MassMassCOGsUnfiltered_90)
length(match_MassCOGsMassUnfiltered_90)
plot(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen))
plot(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)
plot(sort(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen))
plot(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen, mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)
abline(0,1)
head(Mass_ggC_all_gene_freqs_dict)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident > 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident > 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
max(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen))
max(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)
min(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)
"#00000010"
seq(0,1.5,100)
seq(0,1,100)
seq(0,1,11)
seq(0,10,11)
seq(0,1.5,length.ot = 100)
seq(0,1.5,length.out = 100)
heat.colors(150)
heat_col_vec <- heat.colors(150)
round((abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen))*10)
round((abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)*10)
round((abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)*100)
max(round((abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)*100))
heat_col_vec <- heat.colors(150)
heat_col_vec_plt <- heat_col_vec[round((abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)*100)]
head(heat_col_vec_plt)
head(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9))
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)])
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt)
abline(0,1)
heat_col_vec[1]
heat_col_vec[150]
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt, pch = 19)
plot(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen))
plot(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt, pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
))
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt, pch = 19)
length(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen)
length(which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.2))
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.1)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.1)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.05)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.05)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.01)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(abs(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen - mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen < 0.01)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
autRecipMatch_MassCOGggC <- mmseq_results_RecipMassggCMassCOGs_unfiltered$query
autRecipMatch_MassCOGggC <- mmseq_results_RecipMassggCMassCOGs_unfiltered$target
names(autRecipMatch_MassCOGggC) <- mmseq_results_RecipMassggCMassCOGs_unfiltered$query
which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95)
names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] , )
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.1 )
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.05 )
View(mmseq_results_RecipMassggCMassCOGs_unfiltered)
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered == "CLS01535"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS01535"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS339898"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS06224"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03742"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS04709"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS02134"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03500"),]
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] < 0.1))]] > 0.95 )
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03675"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03660"),]
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$evalue < 1.1e-40)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$evalue < 1.1e-40)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", col = heat_col_vec_plt[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)])
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity")
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
par(pty="s")
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.9)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.99)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$evalue < 1.1e-40)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$evalue < 1.1e-40)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
abline(v=0.95)
abline(h=0.2)
#abline(v=0.95)
#abline(h=0.2)
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.2 )
#abline(v=0.95)
#abline(h=0.2)
names(which(Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.2 ))
# find genes that have freq of >0.95 in ggC and <0.05 in COG:
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.05 )
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS04644"),]
length(names(which(Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] > 0.95))]] < 0.2 )))
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS04346"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS04219"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS00638"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03161"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS01052"),]
which (Mass_cog_all_gene_freqs_dict[autRecipMatch_MassCOGggC[names(which(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query] < 0.4))]] > 0.9 )
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS00178"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03825"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS01049"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03675"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS03660"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS02387"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS01448"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS00675"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS04068"),]
mmseq_results_RecipMassggCMassCOGs_unfiltered[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$target == "CLS02742"),]
951/1173
max(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen, mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen)
which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.8)
which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9)
which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9)
intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9))
length(intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9)))
length(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9))]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9))]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[intersect(intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9)), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95))]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[intersect(intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen > 0.9), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen > 0.9)), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95))]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
153/213
Navajo_time_seq <- Navajo_time_points[1]:Navajo_time_points[length(Navajo_time_points)]
seq_no_per_year <- rep(0, length(Navajo_time_seq))
names(seq_no_per_year) <- Navajo_time_seq
for (i in 1:length(Navajo_time_seq)) {
seq_no_per_year[i] <- length(which(Navajo_meta_data$Year==Navajo_time_seq[i]))
}
barplot(seq_no_per_year, xlab = "Sequencing Years", ylab = "Sequence Counts", col = rainbow(15))
1/0.8
mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen
which(0.8 <= mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen <= 1.25)
which(mmseq_results_RecipMassggCMassCOGs_unfiltered$alnlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen <= 1.25)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[intersect(intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen >= 0.8), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen >= 0.8)), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95))]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[intersect(intersect(which(mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen >= 0.8), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$tlen/mmseq_results_RecipMassggCMassCOGs_unfiltered$qlen >= 0.8)), which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95))]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
# new try: take all matches and filter them for at least 80% sequence length of one another and at least 95% quality match. Afterwards try to find the best reciprocal match.
AllMatches_MassggCinCOG <- read.delim("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/MMseqs2_results/AllMatches_ggCMassinCOGMass/MassggCinCOG_AllMatches", header=TRUE)
AllMatches_MassCOGinggC <- read.delim("/Users/llorenz/Documents/PhD_Project/Data/Mapping_ggCaller/MMseqs2_results/AllMatches_COGMassInggCMass/MassCOGinggC_AllMatches", header=TRUE)
head(AllMatches_MassggCinCOG)
# filter for fident>=0.95
AllMatches_MassggCinCOG_hq <- AllMatches_MassggCinCOG[which(AllMatches_MassggCinCOG$fident >= 0.95),]
AllMatches_MassCOGinggC_hq <- AllMatches_MassCOGinggC[which(AllMatches_MassCOGinggC$fident >= 0.95),]
nrow(AllMatches_MassggCinCOG)
nrow(AllMatches_MassggCinCOG_hq)
# filter for sequence length matches
AllMatches_MassggCinCOG_hq_seqlen <- AllMatches_MassggCinCOG_hq[intersect(which(AllMatches_MassggCinCOG_hq$qlen/AllMatches_MassggCinCOG_hq$tlen >= 0.8), which(AllMatches_MassggCinCOG_hq$tlen/AllMatches_MassggCinCOG_hq$qlen >= 0.8)),]
# filter for sequence length matches
AllMatches_MassggCinCOG_hq_seqlen <- AllMatches_MassggCinCOG_hq[intersect(which(AllMatches_MassggCinCOG_hq$qlen/AllMatches_MassggCinCOG_hq$tlen >= 0.8), which(AllMatches_MassggCinCOG_hq$tlen/AllMatches_MassggCinCOG_hq$qlen >= 0.8)),]
AllMatches_MassCOGinggC_hq_seqlen <- AllMatches_MassCOGinggC_hq[intersect(which(AllMatches_MassCOGinggC_hq$qlen/AllMatches_MassCOGinggC_hq$tlen >= 0.8), which(AllMatches_MassCOGinggC_hq$tlen/AllMatches_MassCOGinggC_hq$qlen >= 0.8)),]
nrow(AllMatches_MassggCinCOG_hq_seqlen)
unique(AllMatches_MassggCinCOG_hq_seqlen$query)
length(unique(AllMatches_MassggCinCOG_hq_seqlen$query))
length(unique(AllMatches_MassggCinCOG_hq_seqlen$target))
View(AllMatches_MassggCinCOG_hq_seqlen)
# filter for alignment length
# the same sequence seems to be aligned multiple times, just for shorter alignments
AllMatches_MassggCinCOG_hq_seqlen_alnlen <- AllMatches_MassggCinCOG_hq_seqlen[intersect(which(AllMatches_MassggCinCOG_hq_seqlen$alnlen/AllMatches_MassggCinCOG_hq_seqlen$qlen >= 0.8), which(AllMatches_MassggCinCOG_hq_seqlen$alnlen/AllMatches_MassggCinCOG_hq_seqlen$tlen >= 0.8))]
# filter for alignment length
# the same sequence seems to be aligned multiple times, just for shorter alignments
AllMatches_MassggCinCOG_hq_seqlen_alnlen <- AllMatches_MassggCinCOG_hq_seqlen[intersect(which(AllMatches_MassggCinCOG_hq_seqlen$alnlen/AllMatches_MassggCinCOG_hq_seqlen$qlen >= 0.8), which(AllMatches_MassggCinCOG_hq_seqlen$alnlen/AllMatches_MassggCinCOG_hq_seqlen$tlen >= 0.8)),]
nrow(AllMatches_MassggCinCOG_hq_seqlen_alnlen)
AllMatches_MassCOGinggC_hq_seqlen_alnlen <- AllMatches_MassCOGinggC_hq_seqlen[intersect(which(AllMatches_MassCOGinggC_hq_seqlen$alnlen/AllMatches_MassCOGinggC_hq_seqlen$qlen >= 0.8), which(AllMatches_MassCOGinggC_hq_seqlen$alnlen/AllMatches_MassCOGinggC_hq_seqlen$tlen >= 0.8)),]
nrow(AllMatches_MassCOGinggC_hq_seqlen_alnlen)
# now, check whether forward and backward match is the same
AllMatches_MassggCinCOG_dict <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target
names(AllMatches_MassggCinCOG_dict) <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query
AllMatches_MassCOGinggC_dict <- AllMatches_MassCOGinggC_hq_seqlen_alnlen$target
names(AllMatches_MassCOGinggC_dict) <- AllMatches_MassCOGinggC_hq_seqlen_alnlen$query
head(AllMatches_MassggCinCOG_dict)
head(AllMatches_MassCOGinggC_dict[AllMatches_MassggCinCOG_dict])
recip_matching(AllMatches_MassggCinCOG_dict, AllMatches_MassCOGinggC_dict, rep(0.96, length(AllMatches_MassCOGinggC_dict)), 0.95)
fake_seq_id <- rep(0.96, length(AllMatches_MassCOGinggC_dict))
fake_seq_id <- rep(0.96, length(AllMatches_MassCOGinggC_dict))
names(fake_seq_id) <- names(AllMatches_MassggCinCOG_dict)
length(AllMatches_MassCOGinggC_dict)
length(names(AllMatches_MassggCinCOG_dict))
fake_seq_id <- rep(0.96, length(names(AllMatches_MassggCinCOG_dict)))
names(fake_seq_id) <- names(AllMatches_MassggCinCOG_dict)
recip_matching(AllMatches_MassggCinCOG_dict, AllMatches_MassCOGinggC_dict, fake_seq_id, 0.95)
recip_matches_MassggCCOG <- recip_matching(AllMatches_MassggCinCOG_dict, AllMatches_MassCOGinggC_dict, fake_seq_id, 0.95)
recip_matches_MassCOGggC <- recip_matching(AllMatches_MassCOGinggC_dict, AllMatches_MassggCinCOG_dict, fake_seq_id, 0.95)
par(pty="s")
plot(recip_matches_MassggCCOG[names(recip_matches_MassggCCOG)], Mass_cog_all_gene_freqs_dict[recip_matches_MassggCCOG[names(recip_matches_MassggCCOG)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity")
head(recip_matches_MassggCCOG)
plot(Mass_ggC_all_gene_freqs_dict[names(recip_matches_MassggCCOG)], Mass_cog_all_gene_freqs_dict[recip_matches_MassggCCOG[names(recip_matches_MassggCCOG)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity")
plot(Mass_ggC_all_gene_freqs_dict[names(recip_matches_MassggCCOG)], Mass_cog_all_gene_freqs_dict[recip_matches_MassggCCOG[names(recip_matches_MassggCCOG)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 90% sequence identity", pch = 19)
abline(0,1)
plot(Mass_ggC_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$query[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], Mass_cog_all_gene_freqs_dict[mmseq_results_RecipMassggCMassCOGs_unfiltered$target[which(mmseq_results_RecipMassggCMassCOGs_unfiltered$fident >= 0.95)]], xlab = "Mass ggCaller gene frequencies", ylab = "Mass COG gene frequencies",main="All Gene Frequencies, 95% sequence identity", pch = 19)
abline(0,1)
length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query))
length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$target))
length(AllMatches_MassCOGinggC_hq_seqlen_alnlen)
length(AllMatches_MassCOGinggC_hq_seqlen_alnlen$query)
length(unique(AllMatches_MassCOGinggC_hq_seqlen_alnlen$target))
length(unique(AllMatches_MassCOGinggC_hq_seqlen_alnlen$query))
length(Mass_ggC_all_gene_freqs_dict)
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
head(Mass_ggC_all_gene_freqs_dict_with_matches)
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
for (i in AllMatches_MassggCinCOG_hq_seqlen_alnlen$query) {
print(i)
}
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
}
head(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs)
plot(Mass_ggC_all_gene_freqs_dict_with_matches, Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs)
which(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs > 1)
length(which(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs > 1))
match_dict <- rep("", length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
test_vec <- c(1,2,3)
test_vec <- c(test_vec, 4)
test_vec
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_dict <- rep("", length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
if(!is.element(target_name,match_dict[query_name])){
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
match_dict[query_name] <- c(match_dict[query_name], target_name)
}
}
warnings()
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_dict <- rep(c(), length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
if(!is.element(target_name,match_dict[query_name])){
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
match_dict[query_name] <- c(match_dict[query_name], target_name)
}
}
append(c(), a)
append(c(), 1)
append(c(2), 1)
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_dict <- rep(c(), length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_dict <- rep([], length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
match_dict <- rep([], length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
match_dict <- rep("", length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
if(!is.element(target_name,match_dict[query_name])){
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
match_dict[query_name] <- append(match_dict[query_name], target_name)
}
}
empty_vect <- c()
match_dict <- rep(empty_vect, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(match_dict) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
paste(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[1],AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[1])
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_vec <- c()
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
match_name <- paste(query_name, target_name)
if(!is.element(match_name,match_vec)){
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
match_vec <- append(match_vec, match_name)
}
}
head(match_vec)
plot(Mass_ggC_all_gene_freqs_dict_with_matches, Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs)
plot(Mass_ggC_all_gene_freqs_dict_with_matches, Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs, pch = 19)
once <- c()
more_than_once <- c()
# I will just add the gene freqs together based on the mapping and then see how the correlation is
# will do it one direction first
Mass_ggC_all_gene_freqs_dict_with_matches <- Mass_ggC_all_gene_freqs_dict[unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs <- rep(0, length(unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)))
names(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs) <- unique(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)
match_vec <- c()
once <- c()
more_than_once <- c()
for (i in 1:length(AllMatches_MassggCinCOG_hq_seqlen_alnlen$query)) {
query_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[i]
target_name <- AllMatches_MassggCinCOG_hq_seqlen_alnlen$target[i]
match_name <- paste(query_name, target_name)
if(!is.element(match_name,match_vec)){
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] <- Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[query_name] + Mass_cog_all_gene_freqs_dict[target_name]
match_vec <- append(match_vec, match_name)
if(is.element(query_name,once)){
more_than_once <- append(query_name, more_than_once)
}
if(is.element(target_name,once)){
more_than_once <- append(target_name, more_than_once)
}
once <- append(query_name, once)
once <- append(target_name, once)
}
}
more_than_once
Mass_ggC_all_gene_freqs_dict_with_matches["ERS044030_02273~~~ERS044161_02347"]
Mass_ggC_all_gene_freqs_dict_with_matches[AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[49959]]
AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[49959]
View(AllMatches_MassggCinCOG_hq_seqlen_alnlen)
which(AllMatches_MassggCinCOG_hq_seqlen_alnlen$target == "CLS01053")
Mass_ggC_all_gene_freqs_dict_with_matches[AllMatches_MassggCinCOG_hq_seqlen_alnlen$query[2236]]
Mass_cog_all_gene_freqs_dict["CLS01053"]
intersect(which(Mass_ggC_all_gene_freqs_dict_with_matches > 0.9), which(Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs < 0.2)
)
Mass_ggC_all_gene_freqs_dict_with_matches[c(27,248,481,540,1091,1464,1599,2039)]
Mass_ggC_all_gene_freqs_dict_with_matches_matchfreqs[c(27,248,481,540,1091,1464,1599,2039)]
View(AllMatches_MassCOGinggC_hq_seqlen_alnlen)
