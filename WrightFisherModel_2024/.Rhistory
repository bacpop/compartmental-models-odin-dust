length(names(Nepal_GPSC_numbers_per_year[["1"]]))
names(Nepal_GPSC_numbers_per_year[["1"]])
rev( names(Nepal_GPSC_numbers_per_year[["1"]]))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]], prev_points), col = Nepal_VT_mixed_cols_2[1])
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]], prev_points), col = Nepal_VT_mixed_cols_2[1])
prev_points <- rep(1, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]], prev_points), col = Nepal_VT_mixed_cols_2[1])
Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]]
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year), col = Nepal_VT_mixed_cols_2[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]]/seq_no_per_year, prev_points), col = Nepal_VT_mixed_cols_2[1])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]]/seq_no_per_year
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[2]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[2]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year), col = Nepal_VT_mixed_cols_2[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[1])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[1]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[1])
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year), col = Nepal_VT_mixed_cols_2[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year), col = Nepal_VT_mixed_cols_2[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year
}
sort(Nepal_VT_mixed_cols)
order(Nepal_VT_mixed_cols)
order(Nepal_VT_mixed_cols)[1]
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
#points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:3) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
#points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:3) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
#points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
#prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:3) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
#points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:3) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:3) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:2) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points, prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = sort(Nepal_VT_mixed_cols_2)[i])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
sort(Nepal_VT_mixed_cols_2)
sort(Nepal_VT_mixed_cols)
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1))
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
sort(Nepal_VT_mixed_cols)
Nepal_VT_mixed_cols[order(Nepal_VT_mixed_cols)[i]]
sort(Nepal_VT_mixed_cols)[1]
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]])
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
#for (i in 1:length((Nepal_seq_clusters_dict_common))) {
for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length((Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
# much better to have one list entry per cluster
Nepal_GPSC_numbers_per_year <- list()
for (i in unique(Nepal_seq_clusters_dict)) {
count_vec <- rep(0, length(sort(unique(Nepal_SeqYear_dict))))
names(count_vec) <- as.character(sort(unique(Nepal_SeqYear_dict)))
counts_year <- table(Nepal_SeqYear_dict[names(which(Nepal_seq_clusters_dict == i))])
count_vec[names(counts_year)] <- counts_year
Nepal_GPSC_numbers_per_year[[as.character(i)]] <- count_vec
}
# well, I would definitively need to plot relative counts
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year, type = "l", ylim = c(0, 1))
for (i in unique(Nepal_seq_clusters_dict)) {
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[i]]/seq_no_per_year)
}
# stack them
prev_points <- rep(0, length(seq_no_per_year))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year
}
rowSums(expand.grid(rev(Nepal_GPSC_numbers_per_year)))
rev(Nepal_GPSC_numbers_per_year)
Nepal_GPSC_numbers_per_year[[:]][1]
Nepal_GPSC_numbers_per_year[[]][1]
Nepal_GPSC_numbers_per_year[1]
Nepal_GPSC_numbers_per_year[[1]]
Nepal_GPSC_numbers_per_year[1:10]
Nepal_GPSC_numbers_per_year[1:10][1]
sapply(Nepal_GPSC_numbers_per_year, sum)
sum(Nepal_GPSC_numbers_per_year[[1]])
head(unlist(Nepal_GPSC_numbers_per_year))
apply(Nepal_GPSC_numbers_per_year, 1, sum)
dim(Nepal_GPSC_numbers_per_year)
data.frame(Nepal_GPSC_numbers_per_year)
as.matrix(Nepal_GPSC_numbers_per_year)
as.matrix(data.frame(Nepal_GPSC_numbers_per_year))
rowSums(as.matrix(data.frame(Nepal_GPSC_numbers_per_year)))
rowSums(as.matrix(data.frame(Nepal_GPSC_numbers_per_year)))/seq_no_per_year
seq_no_per_year
head(Nepal_SeqYear_dict)
length(which(Nepal_SeqYear_dict == "2009"))
head(Nepal_seq_clusters_dict)
head(Nepal_SeqYear_dict)
Nepal_time_points
sum(seq_no_per_year)
sum(rowSums(as.matrix(data.frame(Nepal_GPSC_numbers_per_year))))
# seq_no_per_year seems to have too many sequences (probably that I filtered out because of quality concerns)  2610 vs 2454
seq_no_per_year_filtered <- rowSums(as.matrix(data.frame(Nepal_GPSC_numbers_per_year)))
# seq_no_per_year seems to have too many sequences (probably that I filtered out because of quality concerns)  2610 vs 2454
seq_no_per_year_filtered <- rowSums(as.matrix(data.frame(Nepal_GPSC_numbers_per_year)))
# well, I would definitively need to plot relative counts
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1))
for (i in unique(Nepal_seq_clusters_dict)) {
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[i]]/seq_no_per_year_filtered)
}
# use Nepal_VT_mixed for colouring in by VTs
col_clb <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7") #8 colorblind friendly colors
Nepal_VT_mixed_cols <- rep("#E69F00",length(Nepal_VT_mixed))
Nepal_VT_mixed_cols[which(Nepal_VT_mixed == 0)] <- "black"
Nepal_VT_mixed_cols[which(Nepal_VT_mixed == 1)] <- "#CC79A7"
Nepal_VT_mixed_cols_2 <- rep("#E69F0050",length(Nepal_VT_mixed))
Nepal_VT_mixed_cols_2[which(Nepal_VT_mixed == 0)] <- "#00000050"
Nepal_VT_mixed_cols_2[which(Nepal_VT_mixed == 1)] <- "#CC79A750"
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 0.7))
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
}
# add confidence levels to plot
library(DescTools)
Nepal_GPSC_numbers_per_year_conf_low <- list()
Nepal_GPSC_numbers_per_year_conf_up <- list()
for (i in unique(Nepal_seq_clusters_dict)){
clust <- Nepal_GPSC_numbers_per_year[[i]]
for(year in 1:length(clust)){
conf_int <- BinomCI(x = clust[year], n = seq_no_per_year_filtered[year],  conf.level = 0.66)
Nepal_GPSC_numbers_per_year_conf_low[[as.character(i)]][(names(Nepal_GPSC_numbers_per_year[["1"]]))[year]] <- conf_int[1,2]
Nepal_GPSC_numbers_per_year_conf_up[[as.character(i)]][(names(Nepal_GPSC_numbers_per_year[["1"]]))[year]] <- conf_int[1,3]
}
}
#binom_conf_data <- t(sapply(PP_mass_cluster_freq_3, BinomCI, sum(PP_mass_cluster_freq_3,conf.level = 0.66)))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1))
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
}
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1))
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
}
# filter for common clusters (>5% present in at least one year?)
Nepal_seq_clusters_dict_common <- rep(FALSE, length(unique(Nepal_seq_clusters_dict)))
names(Nepal_seq_clusters_dict_common) <- unique(Nepal_seq_clusters_dict)
for (clust in names(Nepal_seq_clusters_dict_common)) {
Nepal_seq_clusters_dict_common[clust] <- (max(Nepal_GPSC_numbers_per_year[[clust]]/seq_no_per_year_filtered)>0.05)
}
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[["1"]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1))
for (i in 1:length((Nepal_seq_clusters_dict_common))) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[i]]]/seq_no_per_year_filtered, col = Nepal_VT_mixed_cols[i])
}
# stack them
prev_points <- rep(0, length(seq_no_per_year_filtered))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1])
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered
}
abline(v = 2015)
# stack them
prev_points <- rep(0, length(seq_no_per_year_filtered))
plot((names(Nepal_GPSC_numbers_per_year[["1"]])), Nepal_GPSC_numbers_per_year[[order(Nepal_VT_mixed_cols)[1]]]/seq_no_per_year_filtered, type = "l", ylim = c(0, 1), col = sort(Nepal_VT_mixed_cols)[1], xlab = "Time", xaxt = "n")
axis(1, at = as.integer(names(Nepal_GPSC_numbers_per_year[["1"]])))
for (i in 1:length(unique(Nepal_seq_clusters_dict))) {
#for (i in 1:1) {
#lines((names(Nepal_GPSC_numbers_per_year_conf_low[["1"]])), Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#lines((names(Nepal_GPSC_numbers_per_year_conf_up[["1"]])), Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]], col = Nepal_VT_mixed_cols_2[i])
#polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), (names(Nepal_GPSC_numbers_per_year[["1"]]))), c(Nepal_GPSC_numbers_per_year_conf_low[[unique(Nepal_seq_clusters_dict)[i]]], Nepal_GPSC_numbers_per_year_conf_up[[unique(Nepal_seq_clusters_dict)[i]]]), col = "grey", density = 10, angle = 45)
lines((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, col = sort(Nepal_VT_mixed_cols)[i])
points((names(Nepal_GPSC_numbers_per_year[["1"]])), prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, col = sort(Nepal_VT_mixed_cols)[i])
polygon(c((names(Nepal_GPSC_numbers_per_year[["1"]])), rev(names(Nepal_GPSC_numbers_per_year[["1"]]))), c(prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered, rev(prev_points)), col = (Nepal_VT_mixed_cols_2)[order(Nepal_VT_mixed_cols)[i]], border = NA)
prev_points <- prev_points + Nepal_GPSC_numbers_per_year[[unique(Nepal_seq_clusters_dict)[order(Nepal_VT_mixed_cols)[i]]]]/seq_no_per_year_filtered
}
abline(v = 2015)
abline(v = 2015, col = "red")
40 /12
